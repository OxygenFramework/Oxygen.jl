<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bigger Applications - Multiple Files · Oxygen.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Oxygen.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><a class="tocitem" href="../../api/">Api</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../guide/">Tutorial - User Guide</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Bigger Applications - Multiple Files</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bigger Applications - Multiple Files</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ndortega/Oxygen.jl/blob/master/docs/src/tutorial/bigger_applications.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Bigger-Applications-Multiple-Files"><a class="docs-heading-anchor" href="#Bigger-Applications-Multiple-Files">Bigger Applications - Multiple Files</a><a id="Bigger-Applications-Multiple-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Bigger-Applications-Multiple-Files" title="Permalink"></a></h1><p>If you are building an application or a web API, it&#39;s rarely the case that you can put everything on a single file.</p><p>As your application grows you&#39;ll need to spread your application&#39;s logic across multiple files. Oxygen provides some tools to help you do this while staying organized.</p><p>Let&#39;s say you have an application that looks something like this:</p><pre><code class="nohighlight hljs">app
├── src
│   ├── main.jl
│   └── routers
│       ├── users.jl
│       └── items.jl
├── Project.toml
└── Manifest.toml</code></pre><h1 id="How-to-use-the-router()-function"><a class="docs-heading-anchor" href="#How-to-use-the-router()-function">How to use the <code>router()</code> function</a><a id="How-to-use-the-router()-function-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use-the-router()-function" title="Permalink"></a></h1><p>Let&#39;s say the file dedicated to handling just users is the submodule at /src/routers/users.jl.</p><p>You want to have the path operations related to your users separated from the rest of the code, to keep it organized.</p><p>You can create the path operations for that module using the <code>router</code> function. </p><p>The <code>router()</code> function is HOF (higher order function) that allows you to reuse the same properties on all other nested routes. </p><pre><code class="language-julia hljs">using Oxygen

hello = router(&quot;/greet/v1/greeting&quot;, tags=[&quot;greet&quot;])

@get hello(&quot;/hi&quot;, tags=[&quot;welcome&quot;]) function(req)
    return &quot;hi&quot;
end

@get hello(&quot;/hello&quot;) function(req)
    return &quot;hello&quot;
end

serve()</code></pre><h2 id="Tagging-your-routes"><a class="docs-heading-anchor" href="#Tagging-your-routes">Tagging your routes</a><a id="Tagging-your-routes-1"></a><a class="docs-heading-anchor-permalink" href="#Tagging-your-routes" title="Permalink"></a></h2><p>By using the hello router in both endpoints, it passes along all the properties as default values. For example If we look at the routes registered in the application they will look like:</p><p><code>/greet/v1/greeting/hi</code> <code>/greet/v1/greeting/hello</code></p><p>Both endpoints in this case will be tagged to the <code>greet</code> tag and the <code>/hi</code> endpoint will have an additional tag appended just to this endpoint called <code>welcome</code>. These tags are used by Oxygen when auto-generating the documentation to organize it by separating the endpoints into sections based off their tags. </p><h2 id="Repeat-Actions"><a class="docs-heading-anchor" href="#Repeat-Actions">Repeat Actions</a><a id="Repeat-Actions-1"></a><a class="docs-heading-anchor-permalink" href="#Repeat-Actions" title="Permalink"></a></h2><p>The <code>router()</code> function also has an <code>interval</code> parameter which is used to call an request handler on a set interval (in seconds). <strong>It&#39;s important to note that request handlers that use this property can&#39;t define additional function parameters outside of the default <code>HTTP.Request</code> parameter.</strong></p><p>In the example below, the <code>/repeat/hello</code> endpoint is called every 0.5 seconds and <code>&quot;hello&quot;</code> is printed to the console on every call</p><pre><code class="language-julia hljs">using HTTP
using Oxygen

repeat = router(&quot;/repeat&quot;, interval=0.5, tags=[&quot;repeat&quot;])

@get repeat(&quot;/hello&quot;) function(req::HTTP.Request)
    println(&quot;hello&quot;)
    return &quot;hello&quot;
end

serve()</code></pre><p>If you want to call an endpoint with parameters on a set interval, you&#39;re better off creating an endpoint to perform the action you want and a second endpoint to call the first on a set interval. </p><pre><code class="language-julia hljs">using HTTP
using Oxygen

repeat = router(&quot;/repeat&quot;, interval=1.5, tags=[&quot;repeat&quot;])

@get &quot;/multiply/{a}/{b}&quot; function(req, a::Float64, b::Float64)
    return a * b
end

@get repeat(&quot;/multiply&quot;) function()
    response = internalrequest(HTTP.Request(&quot;GET&quot;, &quot;/multiply/3/5&quot;))
    println(response)
    return response
end

serve()</code></pre><p>The example above will print the response from the <code>/multiply</code> endpoint in the console below every 1.5 seconds and should look like this:</p><pre><code class="nohighlight hljs">&quot;&quot;&quot;
HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8

15.0&quot;&quot;&quot;</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Sunday 31 July 2022 03:53">Sunday 31 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
