<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cron Scheduling · Oxygen.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Oxygen.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><a class="tocitem" href="../../api/">Api</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../first_steps/">First Steps</a></li><li><a class="tocitem" href="../request_types/">Request Types</a></li><li><a class="tocitem" href="../path_parameters/">Path Parameters</a></li><li><a class="tocitem" href="../query_parameters/">Query Parameters</a></li><li><a class="tocitem" href="../request_body/">Request Body</a></li><li class="is-active"><a class="tocitem" href>Cron Scheduling</a><ul class="internal"><li><a class="tocitem" href="#Cron-Expression-Syntax"><span>Cron Expression Syntax</span></a></li><li><a class="tocitem" href="#Scheduling-Endpoints"><span>Scheduling Endpoints</span></a></li><li><a class="tocitem" href="#Scheduling-Functions"><span>Scheduling Functions</span></a></li><li><a class="tocitem" href="#Starting-and-Stopping-Cron-Jobs"><span>Starting &amp; Stopping Cron Jobs</span></a></li></ul></li><li><a class="tocitem" href="../bigger_applications/">Bigger Applications - Multiple Files</a></li><li><a class="tocitem" href="../oauth2/">OAuth2 with Umbrella.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Cron Scheduling</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cron Scheduling</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ndortega/Oxygen.jl/blob/master/docs/src/tutorial/cron_scheduling.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Cron-Scheduling"><a class="docs-heading-anchor" href="#Cron-Scheduling">Cron Scheduling</a><a id="Cron-Scheduling-1"></a><a class="docs-heading-anchor-permalink" href="#Cron-Scheduling" title="Permalink"></a></h1><p>Oxygen comes with a built-in cron scheduling system that allows you to call endpoints and functions automatically when the cron expression matches the current time.</p><p>When a job is scheduled, a new task is created and runs in the background. Each task uses its given cron expression and the current time to determine how long it needs to sleep before it can execute.</p><p>The cron parser in Oxygen is based on the same specifications as the one used in Spring. You can find more information about this on the <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/scheduling/support/CronExpression.html">Spring Cron Expressions</a> page.</p><h2 id="Cron-Expression-Syntax"><a class="docs-heading-anchor" href="#Cron-Expression-Syntax">Cron Expression Syntax</a><a id="Cron-Expression-Syntax-1"></a><a class="docs-heading-anchor-permalink" href="#Cron-Expression-Syntax" title="Permalink"></a></h2><p>The following is a breakdown of what each parameter in our cron expression represents. While our specification closely resembles the one defined by Spring, it&#39;s not an exact 1-to-1 match.</p><pre><code class="nohighlight hljs">The string has six single space-separated time and date fields:

 ┌───────────── second (0-59)
 │ ┌───────────── minute (0 - 59)
 │ │ ┌───────────── hour (0 - 23)
 │ │ │ ┌───────────── day of the month (1 - 31)
 │ │ │ │ ┌───────────── month (1 - 12) (or JAN-DEC)
 │ │ │ │ │ ┌───────────── day of the week (1 - 7)
 │ │ │ │ │ │          (Monday is 1, Tue is 2... and Sunday is 7)
 │ │ │ │ │ │
 * * * * * *</code></pre><p>Partial expressions are also supported, which means that subsequent expressions can be left out (they are defaulted to <code>&#39;*&#39;</code>). </p><pre><code class="language-julia hljs"># In this example we see only the `seconds` part of the expression is defined. 
# This means that all following expressions are automatically defaulted to &#39;*&#39; expressions
@cron &quot;*/2&quot; function()
    println(&quot;runs every 2 seconds&quot;)
end</code></pre><h2 id="Scheduling-Endpoints"><a class="docs-heading-anchor" href="#Scheduling-Endpoints">Scheduling Endpoints</a><a id="Scheduling-Endpoints-1"></a><a class="docs-heading-anchor-permalink" href="#Scheduling-Endpoints" title="Permalink"></a></h2><p>The <code>router()</code> function has a keyword argument called <code>cron</code>, which accepts a cron expression that determines when an endpoint is called. Just like the other keyword arguments, it can be reused by endpoints that share routers or be overridden by inherited endpoints.</p><pre><code class="language-julia hljs"># execute at 8, 9 and 10 o&#39;clock of every day.
@get router(&quot;/cron-example&quot;, cron=&quot;0 0 8-10 * * *&quot;) function(req)
    println(&quot;here&quot;)
end

# execute this endpoint every 5 seconds (whenever current_seconds % 5 == 0)
every5 = router(&quot;/cron&quot;, cron=&quot;*/5&quot;)

# this endpoint inherits the cron expression
@get every5(&quot;/first&quot;) function(req)
    println(&quot;first&quot;)
end

# Now this endpoint executes every 2 seconds ( whenever current_seconds % 2 == 0 ) instead of every 5
@get every5(&quot;/second&quot;, cron=&quot;*/2&quot;) function(req)
    println(&quot;second&quot;)
end</code></pre><h2 id="Scheduling-Functions"><a class="docs-heading-anchor" href="#Scheduling-Functions">Scheduling Functions</a><a id="Scheduling-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Scheduling-Functions" title="Permalink"></a></h2><p>In addition to scheduling endpoints, you can also use the new <code>@cron</code> macro to schedule functions. This is useful if you want to run code at specific times without making it visible or callable in the API.</p><pre><code class="language-julia hljs">@cron &quot;*/2&quot; function()
    println(&quot;runs every 2 seconds&quot;)
end

@cron &quot;0 0/30 8-10 * * *&quot; function()
  println(&quot;runs at 8:00, 8:30, 9:00, 9:30, 10:00 and 10:30 every day&quot;)
end</code></pre><h2 id="Starting-and-Stopping-Cron-Jobs"><a class="docs-heading-anchor" href="#Starting-and-Stopping-Cron-Jobs">Starting &amp; Stopping Cron Jobs</a><a id="Starting-and-Stopping-Cron-Jobs-1"></a><a class="docs-heading-anchor-permalink" href="#Starting-and-Stopping-Cron-Jobs" title="Permalink"></a></h2><p>When you run <code>serve()</code> or <code>serveparallel()</code>, all registered cron jobs are automatically started. If the server is stopped or killed, all running jobs will also be terminated. You can stop the server and all repeat tasks and cron jobs by calling the <code>terminate()</code> function or manually killing the server with <code>ctrl+C</code>.</p><p>In addition, Oxygen provides utility functions to manually start and stop cron jobs: <code>startcronjobs()</code> and <code>stopcronjobs()</code>. These functions can be used outside of a web server as well.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../request_body/">« Request Body</a><a class="docs-footer-nextpage" href="../bigger_applications/">Bigger Applications - Multiple Files »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Sunday 14 January 2024 22:08">Sunday 14 January 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
